
# Day 14 20240801

## 《给产品经理讲技术》2h

### 网络地址转换
* 每一台连接到网络中的网卡，都需要有一个IP，有了它，网卡才可以在网络中收发信息
* 私有地址：只允许被用在私有网络中，不能作为互联网上的接入地址使用
* 私有网络中的设备，如需访问互联网，需要用到 NAT（Network Address Translation 网络地址转换）
    * 静态转换（static NAT）
        * 内网地址与外网地址一一对应，且对应关系固定
        * 内网有一台主机的时候可用
    * 动态转换（Dynamic NAT）
        * 与静态转换类似，但内外网IP对应关系不固定
    * 端口多路复用（Overload）
        * 可实现1个外网IP地址被多个内网IP同时共享
        * 与前两种的区别：将端口作为一个映射的维度
        * 家用的路由器一般通过端口多路复用来实现NAT
* NAT技术
    * 降低了内网主机直接暴露到外网上的安全风险
    * 端口多路复用技术大大减少了IP地址的需求量，减缓了IP地址的枯竭

### ping和网关
- 检查本机的TCP/IP设置是否正确，可以Ping回环地址（`127.0.0.1`），也称“本机地址”
- 用Ping发现网络异常时，要查看网络配置是否正确，方法：

```sh
bash-3.2$ ifconfig en0
en0: flags=8863<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 1500
        options=400<CHANNEL_IO>
        ether 50:ed:3c:15:9f:a8
        inet6 fe80::1cc8:afc:bd6b:f4f6%en0 prefixlen 64 secured scopeid 0xb 
        inet 172.16.1.188 netmask 0xffff0000 broadcast 172.16.255.255
        nd6 options=201<PERFORMNUD,DAD>
        media: autoselect
        status: active      #联网状态
bash-3.2$ ifconfig en0
en0: flags=8863<UP,BROADCAST,SMART,RUNNING,SIMPLEX,MULTICAST> mtu 1500
        options=400<CHANNEL_IO>
        ether 50:ed:3c:15:9f:a8
        nd6 options=201<PERFORMNUD,DAD>
        media: autoselect
        status: inactive    #未联网状态
```

- 以太网适配器，也称“网卡”，NIC
    - 一种硬件，进行网络传输所用的物理设备，将数据转化为电信号接收/发送
    - 每个网卡在生产时就被赋予了一个 MAC 地址
    - 一台计算机可以有多个网卡
    - 路由器每个端口具有 MAC 地址，也有IP地址，所以路由器也算网卡
- 网关，也称“网间连接器”“协议转换器”, Gateway，作用
    - 桥梁
    - 过滤  
![补充详情](https://blog.csdn.net/Sober_harmonic/article/details/125364085)

### TCP 传输的优点（3条）
- 顺序编号
    - 将大文件分成多个TCP数据包（一般一个装满数据的TCP数据包通常1kB左右）
    - TCP会对每个数据包进行顺序编号，这是提供可靠传输的基础
- 确认机制
    - 接收方会遵循TCP向发送方反馈成功接收的信号 “Acknowledgement, ACK”
- 超时重传
    - 发送方每发送一个数据包，都会为其做一个定时器
    - 如果定时器归零，发送方仍未收到对方的ACK，就会重传该数据包
- 备注：UDP没有确认机制和超时重传

### 反向代理
- 一般的代理
    - 客户端向外界发请求时，将请求交给一个代理服务器，由它负责连接外界的目标服务器
    - 看上去，所有的请求都来自这台代理服务器，客户端在其背后，可以受其保护
- 反向代理
    - 针对服务器的代理服务
    - 反向代理服务器，可以接受客户端的请求，将它分发到被代理的服务器上，这些服务器处理完成请求后，再将结果返回给客户端
    - 代理服务器将服务器隐藏在背后，从客户端角度看，只面对这一台服务器（其实可能背后有很多）
- 反向代理意义
    - 实现负载均衡
        - 多台服务器为一个Web服务时，客户端并不知哪一台比较闲
        - 代理服务器知道每台服务器的负载量，可以把请求转发给相对空闲的，可以更快响应客户端
    - 减轻后端服务器的压力
        - 静态资源或缓存数据，可以直接放在反向代理服务器上
    - 反向代理服务器可以对请求做进一步封装和解封
        - 想升级到SSL加密连接时，可以只在客户端-反向代理服务器之间用SSL加密连接；反向代理服务器-后端服务器的不加，还保持使用http，速度更快
    - 反向代理服务器可以为后端服务器阻挡一些网络攻击

### CDN
- CDN：Content Delivery Network
- 基于互联网的数据量巨大的**服务器集群**，专注于**内容和资源分发**，为用户提供**快速访问资源**的能力，进而提升内容访问的体验
- 开发层面，应用服务器和资源服务器解耦
    - 应用服务器只负责逻辑能力
    - 资源服务器存放内容、资源

### 断点续传背后的故事

# Day 8 20240726 
 《计算机网络》 谢希仁
## Chapter 1
### 概念：
- 网络：若干节点（_node_）和链接这些节点的链路（link）组成。节点可以是计算机、集线器、交换机或路由器
- 互联网：网络和网络连接起来（network of networks），构成了覆盖范围更大的网络，即互联网
- 因特网：世界上最大的互联网络。连接在因特网上的计算机都被称为“主机”。

### 因特网的组成：
- 边缘部分：所有连接在因特网上的主机组成。这部分是用户直接使用，用来通信（传送数据、音频和视频）和资源共享
- 核心部分：大量网络和连接这些网络的路由器组成。这部分是为边缘部分提供服务的（提供连通性和交换）

#### 边缘部分（又称端系统-end system）
- 通信方式：客户/服务器方式 C/S client/server；对等方式 P2P peer/peer 
- C/S：客户运行程序 > 向服务器请求服务 > 服务器运行程序 > 向客户提供服务（客户得到服务）
    - 客户程序向服务器发起通信（请求服务）时，客户程序必须知道服务器程序的地址
    - 客户程序不需要特殊的硬件和复杂的操作系统
    - 服务器被动接受来自各地客户的通信请求，不需要知道客户程序的地址
    - 服务器一般需要强大的硬件和操作系统
    - 客户与服务器通信关系建立后，双方可以双向通信、互相发送和接受数据
- P2P：本质上仍是C/S，只是对等连接中每个主机都既是客户又是服务器

#### 核心部分
- 路由器：一种专用计算机（不是主机），是实现分组交换（packet switching）的关键构建，任务是转发收到的分组——网络核心部分最重要的功能
- 电路交换：通信资源被占用，效率低、浪费资源
- 分组交换：采用存储转发技术（将数据分成等长的块，一块一块的进行传输）
    - 整块数据：报文（message），应用层概念，完整的信息，由传输层交付
    - 必要的控制信息（类似分组依据？）：首部（header）或包头。非常重要，包含了目的地址和源地址等重要信息，分组能因此独立并正确地被交付
    - 数据传输单元：分组（packet），信息在网络中传输的单元，网络层实现分组交付，抓包工具抓到的内容
    区分主机和路由器：
    - 主机是为用户进行信息处理的，可以和其他主机通过网络交换信息（相当于寄快递是 寄件方和收件方）
    - 路由器则用来转发分组，进行分组交换的（相当于快递人员根据收件人信息进行送货）
    路由器暂时存储的是一个个短分组，而非整个长报文；短分组存在路由器的存储器（即内存）中，而不是磁盘中。（缺点：断电后存储器中的数据立即消失，用户端会出现‘发送失败’等类似的异常提示）
### 计算机网络常用的性能指标：
- 速率：比特（bit）是计算机中数据量的单位。速率最重要的性能指标。
- 带宽：bandwidth 一条通信链路的“带宽”越宽，所能传输的“最高数据率”也越高。
- 吞吐量： throughout 单位之间内通过某个网络（或信道、接口）的数据量
- 时延：delay或latency，指数据（一个报文或分组、甚至是比特）从网络（或链路）的一端传送到另一端所需的时间
    - 发送时延 transmission delay 主机或路由器发送数据帧所需的时间；发生在机器内部的发送器上
    - 传播时延 propagation delay 信道中传播一定距离花的时间； 发生在传输信道媒体上
    - 处理时延 如分析分组的首部、差错检验或者查找适当路由等的时间
    - 排队时延
- 时延带宽积 = 传播时延（长度）*带宽（截面）= 管道体积，表示链路可容纳多少比特。
- 往返时间 RTT（Round-Trip Time），从发送到接收接收方的确认信息总共经历的时间
- 信道（网络）利用率：信道利用率指某信道有百分之几的时间是被利用（有数据通过的）；网络利用率是全网螺信道利用率的加权平均值

### 网络协议
#### 网络协议主要由三个要素组成
- 语法，数据与控制信息的结构或格式
- 语义，需要发出何种控制信息，完成何种动作以及作出何种响应
- 同步，事件实现顺序的详细说明

#### 五层协议划分
- 应用层：application layer
- 运输层：transport layer 最重要的协议是传输控制协议TCP、用户数据报协议UDP
- 网络层（网际层）：network layer 最重要的协议IP
- 数据链路层：data link layer
- 物理层：physical layer

## Chapter 2 物理层  #重点是掌握基本概念
### 物理层的主要任务  
* 确定与传输媒体的接口有关的一些特性  
    - 机械特性 形状、尺寸、数量排列等  
    - 电气特性 各条线上的电压范围  
    - 功能特性 指明某条线上出现的某一电平的电压表示何种意义  
    - 过程特性

### 数据通信基本知识
* 数据通信系统可划分为三大部分：
    - 源系统（发送端、发送方）
        - **源点** source 产生要传输的数据
        - **发送器** 典型的发送器是调制器
    - 传输系统 传输网络
    - 目的系统（接收端、接收方）
        - **接收器**典型的是解调器，把模拟信号解调，提取发送端置入的消息
        - **终点** destination 输出信息，也称目的站、信宿
* 通信的目的是传送消息 message，如话音、文字、图像、视频等都是消息
* 数据data是运送消息的实体，通常是有意义的符号序列；信号signal是数据的电器或电磁的表现。信号可分为两类：
    - 模拟信号，或连续信号：代表消息的参数的取值是连续的 
    - 数字信号，或离散信号：代表消息的参数的取值是离散的 

### 关于信道的几个概念：
- 信道不等于电路，信道一般用来表示某一个方向传送信息的媒体；因此，一条电路往往包含一条发送信道+一条接收信道
- 来自信源的信号常称为基带信号，多包含低频成分，而信道无法传输，故需要对基带信号进行调制（modulation）
- 调制Modulation分为两类：
    1. 仅变换基带信号的波形，变换后仍是基带信号，称之为基带调制，或编码 coding
    2. 用载波carrier调制，把基带信号的频率范围搬移到较高的频段，并转换为模拟信号。调制后成为带通信号

- 常用的编码方式：
    1. 不归零：正电平1 负电平0
    2. 归零：正脉冲1，负脉冲0
    3. 曼彻斯特编码：向上跳0，向下跳1
    4. 差分曼彻斯特：位开始有跳变0，反之1

### 限制码元在信道上的传输速度的因素
- 信道能够通过的频率范围
- 信噪比：信号的平均功率和噪声的平均功率之比，S/N 
信噪比越高，信息的传输速率就越高

### 物理层面下的传输媒体
* 导引型传输媒体
    * 双绞线：互相绝缘的铜导线；常见电话线；可加抗干扰屏蔽层
    绞合线类别，一般数字越大带宽越大
    * 同轴电缆：绝缘保护套层、外导体屏蔽层、绝缘层和内导体构成；良好的抗干扰性
    * 光纤：传输带宽远大于其他传输媒体；低损耗，发展迅速

* 非导引型 无线传输  
    红外通信、激光通信，可用于近距离的笔记本电脑相互传输数据

### 信道复用技术
- 频分复用 FDM Frequency Division Multiplexing
- 时分复用 TDM Time Division Multiplexing：用户在每个TDM帧中占固定序号的时隙。也称 isochronous signal
- 波分复用 WDM Wavelength Division Multiplexing
- 码分复用 CDM Code Division Multiplexing 常称为：码分多址 CDMA Code Division Multiple Access

### 数字传输系统
光纤-长途干线最主要的传输媒体，适用于高速率数据业务（如视频会议）和大量复用的低速率业务

### ADSL技术 Asymmetric Digital SUbscriber Line
* 非对称数字用户线技术：用数字技术对现有的模拟电话用户线改造（优点：不需要重新布线）  
    * 0～4kHz 的低频谱留给传统电话；高端频谱用于上网
    * ADSL的下行（从ISP到用户）带宽远大于上行（用户到ISP），所以非对称；不适合企业
    * ADSL 传输距离取决于数据率和用户线的线径（线越细，信号衰减越大）

    
# Day 11 20240729

## 网络是怎么连接的 （40 min）

how to read this book：focus on chapter 1；skim the rest （skip the charts and pictures，try to understand concepts）

### Step 1 生成HTTP请求消息

1. 输入URL
用HTTP协议访问Web服务器时
http://user:password@www.baidu.com:80/dir/file1.htm
#user:password可省略  
#www.baidu.com web服务器域名；如果访问FTP服务器，www则换成ftp  
#80 端口号，可省略  
#/dir/file1.htm 文件的路径名
2. 浏览器解析URL
3. 文件名路径可省略
4. HTTP的基本思路
客户端通过 方法+URI 发送请求消息，服务器通过 状态码 响应消息  
#http的主要方法：GET POST HEAD OPTIONS PUT DELETE TRACE CONNECT
5. 生成HTTP的请求消息
#请求行：请求行+消息头  
#响应消息：状态行+消息头
6. 发送消息后收到响应
    - 200 OK
    - 301 重定向 302临时性重定向
    - 4XX 客户端有问题
        - 400 bad request 语法错误
        - 401 unauthorized 需要认证
        - 403 forbidden 服务器拒绝
        - 404 找不到该资源
    - 5XX 服务器有问题

### Step 2 向DNS服务器查询Web服务器的IP地址
1. IP地址基本知识：每个设备都有一个IP地址
2. 域名和IP地址：机器喜欢数字，so IP地址；但人类不好记数字，so有域名
3. 查询IP地址：通过DNS服务器，调用了socket库的解析器

### Step 3 DNS服务器接力
1. 顺藤摸瓜，直到找到存放请求文件的DNS
2. 缓存：加快响应速度

### Step 4 委托协议栈发消息
1. 发委托时，需要按指定顺序调用socket库

（本书Chapter1内容结束）



## 命令大全 C16 （16:10-16:30 ）
* ip、ftp没有  
* wget类似curl 主要用于下载  
* ssh重点 难 先了解 以后实践 阿里云vm virtual machine
* traceroute netstat wget测试 其他阅读

###  ping （见0727 网络测试工具）
###  traceroute（自习室没网，回家测 0730补充）
traceroute程序可以列出网络流量从本地系统到指定主机经过的所有**跳（hop）**数
```sh
traceroute 域名

➜  notes git:(main) ✗ traceroute jd.com
traceroute: Warning: jd.com has multiple addresses; using 211.144.24.218
traceroute to jd.com (211.144.24.218), 64 hops max, 40 byte packets
 1  * * *
 2  192.168.1.1 (192.168.1.1)  31.554 ms  20.194 ms  20.986 ms
 3  180.159.36.1 (180.159.36.1)  23.289 ms *  26.588 ms
 4  61.172.65.202 (61.172.65.202)  23.791 ms * *
 5  61.152.52.177 (61.152.52.177)  20.116 ms
    61.172.64.169 (61.172.64.169)  21.821 ms
    61.152.54.185 (61.152.54.185)  19.010 ms
 6  61.152.26.42 (61.152.26.42)  21.621 ms *
    61.152.24.118 (61.152.24.118)  29.394 ms
 7  * * *   #星号待查是啥 #当某个步骤的响应超时时，就会使用星号来表示。 这通常是由于被防火墙过滤、网络故障或者网络设备不返回TTL超时错误消息等原因所导致的。
 8  202.97.18.22 (202.97.18.22)  48.171 ms
    202.97.18.10 (202.97.18.10)  47.862 ms
^C
```

###  netstat
用于检查各种网络设置和统计信息；-ie可检查系统的网络接口
###  wget 
用于Web和FTO网站下载文件，可以实现递归下载、后台下载、断点续传等